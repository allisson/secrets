# Database configuration
DB_DRIVER=postgres
# ‚ö†Ô∏è SECURITY WARNING: sslmode=disable is for DEVELOPMENT ONLY
# Production MUST use sslmode=require or sslmode=verify-full
# See docs/operations/security-hardening.md for guidance
DB_CONNECTION_STRING=postgres://user:password@localhost:5432/mydb?sslmode=disable
DB_MAX_OPEN_CONNECTIONS=25
DB_MAX_IDLE_CONNECTIONS=5
DB_CONN_MAX_LIFETIME=5

# Server configuration
SERVER_HOST=0.0.0.0
SERVER_PORT=8080

# Logging
LOG_LEVEL=info

# Metrics configuration
METRICS_ENABLED=true
METRICS_NAMESPACE=secrets

# Master keys (Envelope Encryption)
# Two modes available: KMS Mode (recommended) or Legacy Mode (development only)
#
# === KMS MODE (RECOMMENDED FOR PRODUCTION) ===
# Encrypts master keys at rest using external Key Management Service
# Generate a new KMS master key using: ./bin/app create-master-key --kms-provider=<provider> --kms-key-uri=<uri>
# Rotate master keys using: ./bin/app rotate-master-key --id=<new-key-id>
#
# üîí SECURITY WARNING: KMS_KEY_URI is HIGHLY SENSITIVE
# - Controls access to ALL encrypted data in this deployment
# - NEVER commit KMS_KEY_URI to source control (even private repos)
# - Store in secrets manager (AWS Secrets Manager, GCP Secret Manager, Azure Key Vault, HashiCorp Vault)
# - Use .env files excluded from git (.env is in .gitignore)
# - Inject via CI/CD secrets for automated deployments
# - NEVER use base64key:// provider in staging or production (local development only)
# - Rotate KMS keys quarterly or per organizational policy
# - See docs/configuration.md#kms_key_uri for incident response procedures
#
# KMS Providers:
# - localsecrets: Local testing ONLY (base64key://<32-byte-base64-key>) ‚ùå DO NOT USE IN PRODUCTION
# - gcpkms: Google Cloud KMS (gcpkms://projects/<project>/locations/<location>/keyRings/<ring>/cryptoKeys/<key>)
# - awskms: AWS KMS (awskms:///<key-id> or awskms:///<alias>)
# - azurekeyvault: Azure Key Vault (azurekeyvault://<vault-name>.vault.azure.net/keys/<key-name>)
# - hashivault: HashiCorp Vault (hashivault:///<path>)
#
# Example KMS Mode Configuration (GCP KMS):
# KMS_PROVIDER=gcpkms
# KMS_KEY_URI=gcpkms://projects/my-prod-project/locations/us-central1/keyRings/secrets-keyring/cryptoKeys/master-key
# MASTER_KEYS=default:ARiEeAASDiXKAxzOQCw2NxQfrHAc33CPP/7SsvuVjVvq1olzRBudplPoXRkquRWUXQ+CnEXi15LACqXuPGszLS+anJUrdn04
# ACTIVE_MASTER_KEY_ID=default
#
# Example KMS Mode Configuration (AWS KMS):
# KMS_PROVIDER=awskms
# KMS_KEY_URI=awskms:///alias/secrets-master-key
# MASTER_KEYS=default:ARiEeAASDiXKAxzOQCw2NxQfrHAc33CPP/7SsvuVjVvq1olzRBudplPoXRkquRWUXQ+CnEXi15LACqXuPGszLS+anJUrdn04
# ACTIVE_MASTER_KEY_ID=default
#
# Example Local Development (localsecrets - INSECURE, DEVELOPMENT ONLY):
# KMS_PROVIDER=localsecrets
# KMS_KEY_URI=base64key://smGbjm71Nxd1Ig5FS0wj9SlbzAIrnolCz9bQQ6uAhl4=
# MASTER_KEYS=default:ARiEeAASDiXKAxzOQCw2NxQfrHAc33CPP/7SsvuVjVvq1olzRBudplPoXRkquRWUXQ+CnEXi15LACqXuPGszLS+anJUrdn04
# ACTIVE_MASTER_KEY_ID=default
#
# === LEGACY MODE (DEVELOPMENT ONLY) ===
# ‚ö†Ô∏è SECURITY WARNING: Master keys stored as plaintext base64 - USE ONLY FOR DEVELOPMENT
# Each key must be exactly 32 bytes (256 bits), base64-encoded
# Format: id1:base64key1,id2:base64key2 (comma-separated for multiple keys)
# Generate a new plaintext master key using: ./bin/app create-master-key
#
KMS_PROVIDER=
KMS_KEY_URI=
MASTER_KEYS=default:bEu+O/9NOFAsWf1dhVB9aprmumKhhBcE6o7UPVmI43Y=
ACTIVE_MASTER_KEY_ID=default

# Authentication configuration
# Token expiration in seconds (default: 14400 = 4 hours)
# Migration note: Prior to v0.5.0, default was 86400 (24 hours)
AUTH_TOKEN_EXPIRATION_SECONDS=14400

# Rate limiting configuration (authenticated endpoints)
# Protects against abuse and denial-of-service attacks on authenticated routes
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_SEC=10.0
RATE_LIMIT_BURST=20

# Token endpoint rate limiting (IP-based, unauthenticated)
# Applies to POST /v1/token endpoint to prevent credential stuffing and brute force attacks
# Stricter limits recommended as this endpoint is unauthenticated and commonly targeted
RATE_LIMIT_TOKEN_ENABLED=true
RATE_LIMIT_TOKEN_REQUESTS_PER_SEC=5.0
RATE_LIMIT_TOKEN_BURST=10

# CORS configuration
# ‚ö†Ô∏è SECURITY WARNING: CORS is disabled by default for server-to-server API
# Enable only if browser-based access is required
# Never use "*" for CORS_ALLOW_ORIGINS in production
CORS_ENABLED=false
CORS_ALLOW_ORIGINS=
