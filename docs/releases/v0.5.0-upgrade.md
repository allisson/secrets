# ⬆️ Upgrade Guide: v0.4.x -> v0.5.0

> Last updated: 2026-02-19

Use this guide to safely upgrade from `v0.4.x` to `v0.5.0`.

## What changed

- Default token expiration is now shorter (`24h` -> `4h`)
- Per-client rate limiting is enabled by default
- CORS is configurable and remains disabled by default
- Security hardening guidance expanded for production deployments

## Env diff (copy/paste)

```diff
- AUTH_TOKEN_EXPIRATION_SECONDS=86400
+ AUTH_TOKEN_EXPIRATION_SECONDS=14400

+ RATE_LIMIT_ENABLED=true
+ RATE_LIMIT_REQUESTS_PER_SEC=10.0
+ RATE_LIMIT_BURST=20

+ CORS_ENABLED=false
+ CORS_ALLOW_ORIGINS=
```

If your clients rely on 24-hour tokens, keep explicit configuration:

```dotenv
AUTH_TOKEN_EXPIRATION_SECONDS=86400
```

## Upgrade steps

1. Update image/binary to `v0.5.0`
2. Review and set explicit `AUTH_TOKEN_EXPIRATION_SECONDS`
3. Add `RATE_LIMIT_*` variables with values matching your traffic profile
4. Keep `CORS_ENABLED=false` unless browser-based access is required
5. Restart API servers with updated environment

## Post-upgrade verification

1. Health checks pass: `GET /health`, `GET /ready`
2. Token issuance works and expiration matches expected TTL
3. Authenticated endpoint rate limit returns `429` with `Retry-After` when exceeded
4. Normal traffic does not hit `429` unexpectedly
5. CORS behavior is correct for your deployment mode

## Quick checks

```bash
# token issue still works
curl -i -X POST http://localhost:8080/v1/token \
  -H "Content-Type: application/json" \
  -d '{"client_id":"<id>","client_secret":"<secret>"}'

# protected route may return 200/403/429 depending on policy and load
curl -i http://localhost:8080/v1/clients \
  -H "Authorization: Bearer <token>"
```

## See also

- [v0.5.0 release notes](v0.5.0.md)
- [Release compatibility matrix](compatibility-matrix.md)
- [Environment variables](../configuration/environment-variables.md)
- [Security hardening guide](../operations/security-hardening.md)
